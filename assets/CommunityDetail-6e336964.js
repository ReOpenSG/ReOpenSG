import{p as s,i as I,j as e,d as L,s as w}from"./index-6ffcc819.js";import{r as l}from"./react-3321cb07.js";/* empty css                      */import{B}from"./BannerSection-3199f79d.js";import{d as E,b as W,e as O}from"./fbStore-ed2d4d67.js";import{d as _,N as T,u as F,e as Q}from"./reactRouter-dd40e030.js";import{r as z,d as G}from"./fbStorage-a10cdba0.js";import{Q as x}from"./react-toastify.esm-32f2537d.js";import{d as H}from"./recoil-6524b0a4.js";import{s as n}from"./styles.module-9ce859ce.js";import"./fbAuth-9e87268e.js";import"./fbApp-26a327c1.js";import"./animations-1dde62f3.js";function A({currentNotice:a,nextNotice:t,prevNotice:o,notices:r,params:h}){var S,y,d,p,u,P,i,R,U;const m=_(),C=H(I),c=(S=a==null?void 0:a.data)!=null&&S.updatedAt?new Date(a.data.updatedAt.seconds*1e3+a.data.updatedAt.nanoseconds/1e6):null,g=c==null?void 0:c.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),j=()=>{m(`/community/${a==null?void 0:a.id}/edit`,{state:{currentNotice:a,notices:r}})},f=async()=>{try{const D=E(L,"community",h.id),k=await W(D);if(await O(D),k.exists()){const{imageUrl:$}=k.data();if($){const q=z(w,`images/community/${h.id}`);await G(q)}}x.success("글이 삭제되었습니다."),m("/community")}catch{x.error("글 삭제 중 오류가 발생했습니다.")}},b=()=>{m("/community")};return a?e.jsxs("section",{className:n.detailWrapper,children:[e.jsxs("div",{className:n.titleWrapper,children:[e.jsx("h3",{className:n.title,children:(y=a==null?void 0:a.data)==null?void 0:y.title}),e.jsx("time",{className:n.updatedAt,dateTime:g,children:g})]}),e.jsx("div",{className:n.buttonWrapper,children:C?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`${n.button} ${n.editButton}`,onClick:j,children:"수정"}),e.jsx("button",{type:"button",className:`${n.button} ${n.deleteButton}`,onClick:f,children:"삭제"})]}):""}),e.jsxs("div",{className:n.contentWrapper,children:[e.jsx("img",{src:(d=a==null?void 0:a.data)==null?void 0:d.imageUrl,alt:(p=a==null?void 0:a.data)==null?void 0:p.title,className:n.imagePreview}),e.jsx("p",{className:n.contentText,children:(u=a==null?void 0:a.data)==null?void 0:u.content})]}),e.jsxs("ul",{className:n.navWrapper,children:[e.jsx("li",{className:n.list,children:t?e.jsxs(T,{to:`/community/${t==null?void 0:t.id}`,state:{currentNotice:t,notices:r},className:"flex gap-open-lg",children:[e.jsx("span",{className:"font-semibold",children:"↑   다음 글"}),e.jsx("span",{children:(P=t==null?void 0:t.data)==null?void 0:P.title})]}):e.jsxs(T,{to:"#",className:"flex gap-open-lg",onClick:()=>x("다음 글이 없습니다."),children:[" ",e.jsx("span",{className:"font-semibold",children:"↑   다음 글"}),t&&e.jsx("span",{children:(i=t==null?void 0:t.data)==null?void 0:i.title}),!t&&e.jsx("span",{children:"다음 글이 없습니다."})]})}),e.jsx("li",{className:n.list,children:o?e.jsxs(T,{to:`/community/${o==null?void 0:o.id}`,state:{currentNotice:o,notices:r},className:"flex gap-open-lg",children:[e.jsx("span",{className:"font-semibold",children:"↓   이전 글"}),e.jsx("span",{children:(R=o==null?void 0:o.data)==null?void 0:R.title})]}):e.jsxs(T,{to:"#",className:"flex gap-open-lg",onClick:()=>x("이전 글이 없습니다."),children:[" ",e.jsx("span",{className:"font-semibold",children:"↓   이전 글"}),o&&e.jsx("span",{children:(U=o==null?void 0:o.data)==null?void 0:U.title}),!o&&e.jsx("span",{children:"이전 글이 없습니다."})]})})]}),e.jsxs("button",{type:"button",className:n.comebackButton,onClick:b,children:[" ",e.jsx("span",{className:"block font-open-highlight",children:"목록으로"}),e.jsx("span",{className:"font-extralight",children:"> "}),"  "," "]})]}):e.jsx("div",{children:"Loading..."})}A.propTypes={currentNotice:s.PropTypes.shape({id:s.PropTypes.string,data:s.PropTypes.shape({index:s.PropTypes.number,title:s.PropTypes.string,content:s.PropTypes.string,imageUrl:s.PropTypes.string,updatedAt:s.PropTypes.objectOf({seconds:s.PropTypes.number,nanoseconds:s.PropTypes.number})}).isRequired}),nextNotice:s.PropTypes.shape({id:s.PropTypes.string,data:s.PropTypes.shape({index:s.PropTypes.number,title:s.PropTypes.string,content:s.PropTypes.string,imageUrl:s.PropTypes.string,updatedAt:s.PropTypes.shape({seconds:s.PropTypes.number,nanoseconds:s.PropTypes.number})})}),prevNotice:s.PropTypes.shape({id:s.PropTypes.string,data:s.PropTypes.shape({index:s.PropTypes.number,title:s.PropTypes.string,content:s.PropTypes.string,imageUrl:s.PropTypes.string,updatedAt:s.PropTypes.shape({seconds:s.PropTypes.number,nanoseconds:s.PropTypes.number})})}),notices:s.PropTypes.arrayOf(s.PropTypes.shape({id:s.PropTypes.string.isRequired,data:s.PropTypes.shape({index:s.PropTypes.number,title:s.PropTypes.string,content:s.PropTypes.string,imageUrl:s.PropTypes.string,updatedAt:s.PropTypes.shape({seconds:s.PropTypes.number,nanoseconds:s.PropTypes.number})}).isRequired})).isRequired,params:s.PropTypes.shape({id:s.PropTypes.string.isRequired}).isRequired};A.defaultProps={currentNotice:{id:"",data:{index:0,title:"",content:"",imageUrl:"",updatedAt:{seconds:0,nanoseconds:0}}},nextNotice:{id:"",data:{index:0,title:"",content:"",imageUrl:"",updatedAt:{seconds:0,nanoseconds:0}}},prevNotice:{id:"",data:{index:0,title:"",content:"",imageUrl:"",updatedAt:{seconds:0,nanoseconds:0}}}};function ns(){const a=F(),t=Q(),[o,r]=l.useState([]),[h,m]=l.useState(null),[C,c]=l.useState(-1),[g,j]=l.useState(null),[f,b]=l.useState(null);return l.useEffect(()=>{(async()=>{const{currentNotice:y,notices:d}=a.state||{};if(y){m(y);const p=d.findIndex(i=>(i==null?void 0:i.id)===(t==null?void 0:t.id));c(p);const u=p>0?d[p-1]:null,P=p<d.length-1?d[p+1]:null;r(d),j(u),b(P)}})()},[a.state,t.id]),e.jsxs("div",{className:n.communityDetail,children:[e.jsx(B,{category:"Support",title:"커뮤니티"}),e.jsx(A,{notices:o,currentNotice:h,params:t,nextNotice:g,prevNotice:f})]})}export{ns as default};
